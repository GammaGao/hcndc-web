* [1.系统架构](#1.系统架构)
* [2.环境部署](#2.环境部署)
    * [2.1 python3.6.\*安装](#2.1 python3.6.\*安装)
    * [2.2 mysql5.\*安装](#2.4 mysql5.\*安装)
* [3.项目部署](#3.项目部署)
    * [3.1 中间件依赖](#3.1 中间件依赖)
    * [3.2 安装python相关依赖包](#3.2 安装python相关依赖包)
        * [3.2.1 服务端-master(1台机器)](#3.2.1 服务端-master(1台机器))
        * [3.2.2 执行端-exector(所有机器)](#3.2.2 执行端-exector(所有机器))
    * [3.3 生成mysql配置表](#3.3 生成mysql配置表)
* [4.启动程序](#4.启动程序)
    * [4.1 服务端](#4.1 服务端)
    * [4.2 执行端](#4.2 执行端)



# 1.系统架构

![架构](C:\Users\xuex\Desktop\framework.png)

# 2.环境部署
## 2.1 python3.6.\*安装
### 安装开发包
```
yum -y groupinstall "Development tools"

yum -y install zlib-devel bzip2-devel openssl-devel ncurses-devel sqlite-devel readline-devel tk-devel gdbm-devel db4-devel libpcap-devel xz-devel
```
### 下载python包
```
cd ~
wget https://www.python.org/ftp/python/3.6.6/Python-3.6.6.tgz﻿
```
### 安装
```
# 解压
tar -zxvf Python-3.6.6.tgz
# 移动
mv ./Python-3.6.6 /usr/local/python3
# 编译安装
./configure --prefix=/usr/local/python3
make && make install
```

### 配置

```
# 软链接

ln -s /usr/local/python3/bin/python3 /usr/bin/python3
ln -s /usr/local/python3/bin/pip3 /usr/bin/pip3

# 添加环境变量
vi ~/.bash_profile
PATH=$PATH:$HOME/bin:/usr/local/python3/bin
# 激活环境变量
source ~/.bash_profile
```

## 2.2 mysql5.\*安装
略


# 3.项目部署
## 3.1 中间件依赖
```
fluentd——日志流处理工具
mongdb——日志存储数据库
mysql——配置数据库
python3.6——执行环境
uwsgi——web服务器
```

## 3.2 安装python相关依赖包
### 3.2.1 服务端-master(1台机器)
cd /HCNDC-web
pip install -r requirements.txt

### 3.2.2 执行端-exector(所有机器)
cd /HCNDC-exec
pip install -r requirements.txt

## 3.3 生成mysql配置表
执行"调度平台数据库ddl.txt"SQL语句

```
配置主要字段说明：
1.mysql对象：mysql的配置
2.log对象：fluentd日志的配置
3.mongo对象：mongo数据库的配置
4.schedule对象：调度并发数，每个任务最大实例数配置
5.exec对象：执行端的端口，持久化的表名
6.master对象：服务端的IP和端口
```
# 4.启动程序
## 4.1 服务端
cd /HCNDC-web
python server.py
## 4.2 执行端
cd /HCNDC-exec
python server.py

